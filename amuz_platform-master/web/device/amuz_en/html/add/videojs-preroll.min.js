/*! videojs-preroll - v0.2.0 - 2014-12-19
* Copyright (c) 2014 Sano Webdevelopment;
* Copyright (c) 2014 The Onion
* Licensed MIT */
!function(a,b){"use strict";var c,d={src:"",href:"",target:"_blank",allowSkip:!0,skipTime:5,repeatAd:!1};c=function(c){var e=b.util.mergeOptions(d,c),f=this;f.preroll={adDone:!1},f.on("contentupdate",function(){f.trigger(f.preroll.shouldPlayPreroll()?"adsready":"adscanceled")}),f.on("readyforpreroll",function(){if(!f.preroll.shouldPlayPreroll())return void f.trigger("adscanceled");if(f.ads.startLinearAdMode(),f.src(e.src),f.one("durationchange",function(){f.play()}),f.one("progress",function(){f.play()}),""!==e.href){var b=document.createElement("a");b.className="preroll-blocker",b.href=e.href,b.target=e.target||"_blank",b.onclick=function(){f.trigger("adclick")},f.preroll.blocker=b,f.el().insertBefore(b,f.controlBar.el())}if(e.allowSkip!==!1){var c=document.createElement("div");c.className="preroll-skip-button",f.preroll.skipButton=c,f.el().appendChild(c),c.onclick=function(b){var c=c||a.Event;return(" "+f.preroll.skipButton.className+" ").indexOf(" enabled ")>=0&&f.preroll.exitPreroll(),void 0===c.prototype.stopPropagation?!1:void b.stopPropagation()},f.on("timeupdate",f.preroll.timeupdate)}f.one("ended",f.preroll.exitPreroll),f.one("error",f.preroll.prerollError)}),f.preroll.shouldPlayPreroll=function(){return""===e.src?!1:f.preroll.adDone===!0?!1:!0},f.preroll.exitPreroll=function(){"undefined"!=typeof f.preroll.skipButton&&f.preroll.skipButton.parentNode.removeChild(f.preroll.skipButton),"undefined"!=typeof f.preroll.blocker&&f.preroll.blocker.parentNode.removeChild(f.preroll.blocker),f.off("timeupdate",f.preroll.timeupdate),f.off("ended",f.preroll.exitPreroll),f.off("error",f.preroll.prerollError),e.repeatAd!==!0&&(f.preroll.adDone=!0),f.ads.endLinearAdMode()},f.preroll.timeupdate=function(){f.loadingSpinner.el().style.display="none";var a=Math.ceil(e.skipTime-f.currentTime());a>0?f.preroll.skipButton.innerHTML="Skip in "+a+"...":-1===(" "+f.preroll.skipButton.className+" ").indexOf(" enabled ")&&(f.preroll.skipButton.className+=" enabled",f.preroll.skipButton.innerHTML="Skip")},f.preroll.prerollError=function(){f.preroll.exitPreroll()},f.currentSrc()&&f.trigger(f.preroll.shouldPlayPreroll()?"adsready":"adscanceled")},b.plugin("preroll",c)}(window,window.videojs);